(()=>{function s(){return typeof browser<"u"&&typeof browser.runtime<"u"}function n(){return s()?browser:typeof chrome<"u"?chrome:null}function a(e){let r=n();return r?.storage?.local?s()?r.storage.local.set(e):new Promise(o=>{r.storage.local.set(e,()=>o())}):Promise.resolve()}function i(e){let r=n();r?.runtime?.onMessage&&r.runtime.onMessage.addListener(e)}function l(e){let r=n();r?.runtime?.onInstalled&&r.runtime.onInstalled.addListener(e)}function u(e){let r=n();return r?.downloads?.download?s()?r.downloads.download(e):new Promise((o,t)=>{r.downloads.download(e,d=>{r.runtime.lastError?t(new Error(r.runtime.lastError.message)):o(d)})}):Promise.reject(new Error("downloads API unavailable"))}l(e=>{e.reason==="install"&&(a({showButtons:!0,mathMode:"omml",darkThemeDocx:!1}),console.log("[ChatGPT\u2192Word Copier] Extension installed"))});i((e,r,o)=>(e.type==="download"&&(f(e.data,e.filename,e.mimeType),o({success:!0})),!1));function f(e,r,o){u({url:e,filename:r,saveAs:!0}).catch(t=>console.error("[ChatGPT\u2192Word Copier] Download error:",t))}console.log("[ChatGPT\u2192Word Copier] Background service worker loaded");})();
